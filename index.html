<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">

  <!-- Kakao JavaScript SDK 로드 -->
  <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
  <script>
    // Kakao SDK 초기화 (실제 발급받은 JavaScript 키로 교체)
    Kakao.init('90ed090fa6d7044e65e276410a0232d7');

    // 모바일 기기 감지 함수
    function isMobile() {
      return /Mobi|Android/i.test(navigator.userAgent);
    }

    // 카카오 로그인(및 간편가입) 함수
    function loginWithKakao() {
      var options = {
        // 필요한 동의 항목을 추가하세요.
        // 간편가입을 위해 프로필 정보, 이메일 등 동의를 요청할 수 있습니다.
        scope: 'profile_nickname, profile_image, account_email',
        success: function(authObj) {
          console.log("로그인/간편가입 성공:", authObj);
          // 로그인 성공 후 사용자 정보 요청
          Kakao.API.request({
            url: '/v2/user/me',
            success: function(res) {
              console.log("사용자 정보:", res);
              var nickname = res.kakao_account.profile.nickname;
              document.getElementById('userInfo').innerText = "안녕하세요, " + nickname + "님!";
            },
            fail: function(error) {
              console.error("사용자 정보 요청 실패:", error);
            }
          });
        },
        fail: function(err) {
          console.error("로그인/간편가입 실패:", err);
        }
      };

      // 모바일 환경이면 카카오톡 앱을 통한 네이티브 로그인 시도
      if (isMobile()) {
        options.throughTalk = true;
      }
      
      Kakao.Auth.login(options);
    }
  </script>
</head>
<body>

  <!-- 사용자가 클릭하면 loginWithKakao() 함수가 실행됩니다 -->
  <button onclick="loginWithKakao()">카카오 로그인/간편가입</button>
  <div id="userInfo"></div>
</body>
</html>
